/**
 * @file config.h
 * @brief Pico 2W Bluetooth A2DP Audio Receiver - 設定ファイル
 */

#ifndef CONFIG_H
#define CONFIG_H

// ============================================================================
// Bluetooth 設定
// ============================================================================

// デバイス名（Bluetooth接続時に表示される名前）
#define BT_DEVICE_NAME "Pico2W Audio Receiver"

// Bluetooth クラス（オーディオデバイスとして認識されるように設定）
#define BT_DEVICE_CLASS 0x200420  // Audio/Video - Loudspeaker

// ============================================================================
// オーディオ出力モード選択
// ============================================================================

// I2S DAC 出力専用モード（PWM出力は廃止）
#define USE_I2S_OUTPUT     1

// ============================================================================
// I2S DAC 設定（PCM5102A などの I2S DAC を使用する場合）
// ============================================================================

// I2S ピン配置
#define I2S_DATA_PIN    26    // DIN (Data)
#define I2S_BCLK_PIN    27    // BCK (Bit Clock)
#define I2S_LRCLK_PIN   28    // LCK (Left/Right Clock / Word Select)

// サンプリングレート（Hz）
#define AUDIO_SAMPLE_RATE    44100

// ビット深度
#define AUDIO_BITS_PER_SAMPLE 16

// チャンネル数（ステレオ）
#define AUDIO_CHANNELS        2

// ============================================================================
// オーディオバッファ設定
// ============================================================================

// リングバッファサイズ（サンプル数）
// 大きいほど安定するが、遅延も増える
// 1秒分（メモリ制約内で最大限の安定性を確保）
// RP2350のSRAMは264KBなので、4秒（689KB）は不可能
#define AUDIO_BUFFER_SIZE    (AUDIO_SAMPLE_RATE * 1)  // 1秒分 = 44100サンプル

// DMA バッファサイズ（サンプル数）
#define DMA_BUFFER_SIZE      512

// バッファアンダーラン/オーバーラン検出の閾値
#define BUFFER_LOW_THRESHOLD    (AUDIO_BUFFER_SIZE / 4)
#define BUFFER_HIGH_THRESHOLD   (AUDIO_BUFFER_SIZE * 3 / 4)

// ============================================================================
// デバッグログ設定
// ============================================================================

// デバッグログを有効化
#define ENABLE_DEBUG_LOG     1

// バッファ状態のログ出力間隔（ミリ秒）
#define BUFFER_STATUS_LOG_INTERVAL_MS  5000

// 統計情報のログ出力頻度（N回ごと）
#define STATS_LOG_FREQUENCY    100

// PCMデータ受信の初期ログ出力回数
#define INITIAL_PCM_LOG_COUNT  5

// メディアパケット受信の初期ログ出力回数
#define INITIAL_MEDIA_LOG_COUNT  3

// ============================================================================
// システム設定
// ============================================================================

// USB シリアル接続の安定化待ち時間（ミリ秒）
#define USB_SERIAL_STABILIZATION_MS  2000

// DMA 割り込み優先度（0x00=最高、0xFF=最低）
// Bluetooth処理を妨害しないため、最低優先度に設定
#define DMA_IRQ_PRIORITY  0xFF

// ============================================================================
// Bluetooth プロトコル設定
// ============================================================================

// SBC メディアパケットのヘッダーオフセット（バイト）
// A2DPパケットの最初13バイトはヘッダーで、実際のSBCデータはその後
#define SBC_MEDIA_PACKET_HEADER_OFFSET  13

// SDP AVDTP Sink サービスバッファサイズ（バイト）
#define SDP_AVDTP_SINK_BUFFER_SIZE  150

// ============================================================================
// PIO I2S 設定
// ============================================================================

// PIO クロックサイクル数（1ステレオペアあたり）
// 左チャンネル33サイクル + 右チャンネル33サイクル = 66サイクル
#define PIO_CYCLES_PER_STEREO_SAMPLE  66

#endif // CONFIG_H
